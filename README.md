<img src="excel-playwright-test/images/image.png" width="1000" height="300">

<br>

# Senior Quality Assurance Engineer test task project

This project contains automated tests for Excel using Playwright, as well as manual test documentation for an algorithm that increments a string.
It was developed as part of the Senior Quality Assurance Engineer test task at Velixo.

## Project Structure

```
.
├── excel-playwright-test/    # Automated tests with Playwright
└── manual-test/              # Manual test documentation
```

## Automated Tests (Playwright)

### Requirements
- Node.js (latest LTS version)
- npm (comes with Node.js)

### Installation

1. Navigate to the `excel-playwright-test` folder:
```bash
cd excel-playwright-test
```

2. Install dependencies:
```bash
npm install
```

3. Install Playwright browsers:
```bash
npx playwright install
```

### Authentication Setup - ***REQUIRED***

Before running the tests, you need to set up authentication to bypass the UI login so that manual login is not required for a long time:

1. Run the authentication script:
```bash
npx ts-node scripts/record-auth.ts
```

2. Follow the prompts to:
   - Login manually to your Microsoft account (outlook or hotmail)
   - Complete 2FA if required
   - Wait for the process to complete
   - The script will save your authentication state to `storage/auth.json`

### Running Tests

To run the automated tests:

```bash
cd excel-playwright-test
```
*and*
```bash
npx playwright test
```

*OR* 

```bash
cd excel-playwright-test
```
*and*
```bash
npx playwright test --ui 
``` 
and press play button

### Implemented Tests

#### Excel TODAY() formula test
- Location: `tests/excel-today.spec.ts`
- Purpose: Validates that the Excel Online TODAY() function returns the current date
- Test Steps:
  1. Opens Excel Online
  2. Creates a new blank workbook
  3. Inserts TODAY() function in the first cell
  4. Validates the returned date matches the current date

#### 

## Reports

Test execution reports can be found in:
- Automated tests: `excel-playwright-test/playwright-report/`
- Test results: `excel-playwright-test/test-results/`

## Workarrounds

- storageState: To log in to Excel, it was necessary to perform a manual login once using *storageState*, save the session state *(storage/auth.json)*, and reuse it in the tests. This was required because regular accounts (Outlook/Hotmail) used for automated UI login were being blocked.\
*Limitation:* the session expires after a few days → it must be recorded again and cannot be used in CI/CD (e.g., GitHub Actions).

- aria-label: To validate the value generated by the *TODAY()* formula matched the current date, it was necessary to retrieve the aria-label attribute from the HTML after a few seconds, because Playwright has many limitations when interacting with Excel Online, which is rendered inside a *canvas view*.

## Improvements 

- storageState:

  - Integrate with a company/tenant account instead of Outlook/Hotmail to reduce login blocks.

- aria-label:

  - In long term, consider validating through Microsoft Graph API, which provides direct access to cell values, bypassing canvas limitations.

- helpers:

  - Add helper files (e.g., createNewExcelWorkbook) containing groups of Playwright actions that can be reused for other interactions. 

<br>

---
---  

<br>

## Manual Testing

Located in the `manual-test` folder, this section contains documentation for manual testing of a string increment algorithm.

### Test Techniques Applied

1. **Boundary Value Analysis (BVA)**
   - Applied to test minimum and maximum input limits
   - Letters range: 1-4 characters
   - Digits range: 1-4 digits

2. **Equivalence Partitioning (EP)**
   - Used to create representative test cases
   - Covers combinations of letters (L1-L4) and digits (D1-D4)
   - Includes both valid and invalid input scenarios

### Test Documentation
- Detailed test cases are documented in `manual-test/task-1.md`
- Includes test case IDs, descriptions, inputs, and expected outputs
- Covers both valid and invalid scenarios
- Focuses on string increment algorithm validation

<br>

---
---  

<br>

## Technologies Used

- TypeScript
- Playwright
- Microsoft Excel Online